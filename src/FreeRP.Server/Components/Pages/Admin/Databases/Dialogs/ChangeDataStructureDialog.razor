@using FreeRP.Database
@inject FreeRP.Localization.FrpLocalizationService i18n

<MudDialog>
    <DialogContent>
        <MudForm>
            <MudTextField @bind-Value="Dataset.DatasetId" InputType="InputType.Text" Label="@i18n.Text.Id"
                          Required="true" RequiredError="@i18n.Text.ErrorDataStructureIdRequired" />

            <MudTextField @bind-Value="Dataset.Name" InputType="InputType.Text" Label="@i18n.Text.Name" />
            <MudTextField @bind-Value="Dataset.Description" InputType="InputType.Text" Label="@i18n.Text.Description" Lines="3" />

            <MudSwitch Class="mt-2" @bind-Value="Dataset.AllowUnknownFields" Label="@i18n.Text.AllowUnknownFields" />

        </MudForm>
    </DialogContent>
    <DialogActions>
        @if (string.IsNullOrEmpty(Dataset.DatasetId))
        {
            <MudButton OnClick="Cancel">@i18n.Text.Cancel</MudButton>
        }
        <MudButton Color="Color.Primary" OnClick="Save">@i18n.Text.Ok</MudButton>
    </DialogActions>
</MudDialog>

@code {

    [CascadingParameter]
    public MudDialogInstance Dialog { get; set; } = default!;

    [Parameter]
    public FrpDataset Dataset { get; set; } = default!;

    protected override void OnInitialized()
    {
        i18n.TextChanged += () => StateHasChanged();
    }

    private void Cancel() => Dialog.Cancel();

    private void Save()
    {
        Dialog.Close();
    }
}
